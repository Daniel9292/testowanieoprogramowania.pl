<!DOCTYPE html>
<html lang="pl">
  <head>
    <meta charset="utf-8">
    <meta name="description" content="Wydarzenia zwiÄ…zane z testowaniem oprogramowania - konferencje, meetupy">
    <title>Wydarzenia - Testowanie Oprogramowania</title>
    <link href='https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;400;600&display=swap' rel='stylesheet'>
    <link rel="stylesheet" href="styles.css">
    <style>
      .container {
        max-width: 900px;
        margin: 0 auto;
        padding: 20px;
      }
      
      .tabs {
        display: flex;
        justify-content: center;
        margin-bottom: 20px;
        flex-wrap: nowrap;
      }
      
      .tab {
        background: #232323;
        color: white;
        padding: 10px 30px;
        margin: 0 5px;
        cursor: pointer;
        font-family: 'Open Sans', sans-serif;
        font-weight: 600;
        font-size: 16px;
        border: 2px solid #232323;
        transition: 0.25s;
      }
      
      .tab:hover, .tab.active {
        background: white;
        color: #232323;
      }
      
      .links {
        display: flex;
        justify-content: center;
        margin: 20px 0;
      }
      
      .links a {
        width: auto;
        padding: 10px 20px;
        margin: 0 5px;
        font-size: 14px;
      }
      
      .event {
        text-align: left;
        border-bottom: 1px solid #eee;
        padding: 20px 0;
        font-family: 'Open Sans', sans-serif;
      }
      
      .event h3 {
        margin: 0;
        padding: 0;
        text-align: left;
        font-size: 26px;
        font-weight: 600;
        color: #00468B;
      }
      
      .event h3 a {
        color: #00468B;
        text-decoration: none;
        background: transparent;
        padding: 0;
        width: auto;
        border: none;
        display: inline;
      }
      
      .event h3 a:hover {
        text-decoration: underline;
        background: transparent;
        color: #00468B;
      }
      
      .event-info {
        display: flex;
        align-items: center;
        margin: 10px 0;
        font-size: 16px;
      }
      
      .event-info i {
        margin-right: 10px;
        width: 20px;
        text-align: center;
      }
      
      .event-status {
        margin-top: 10px;
        font-weight: 600;
      }
      
      .twitter-link {
        color: #1DA1F2;
        text-decoration: none;
        font-weight: 600;
      }
      
      .twitter-link:hover {
        text-decoration: underline;
      }
      
      .event-button {
        display: inline-block;
        background: #232323;
        color: white;
        padding: 6px 12px;
        border-radius: 4px;
        font-size: 14px;
        text-decoration: none;
        border: 2px solid #232323;
        transition: 0.25s;
      }
      
      .event-button:hover {
        background: white;
        color: #232323;
      }
      
      .home-link {
        display: inline-block;
        margin: 20px 0;
        font-size: 14px;
        width: auto;
        padding: 10px 20px;
      }
      
      .add-event-btn {
        background: #00468B;
        color: white;
        padding: 10px 30px;
        margin-left: 15px;
        border: 2px solid #00468B;
        border-radius: 4px;
        font-family: 'Open Sans', sans-serif;
        font-weight: 600;
        font-size: 18px;
        cursor: pointer;
        transition: 0.25s;
        display: flex;
        align-items: center;
      }
      
      .add-event-btn i {
        margin-right: 8px;
      }
      
      .add-event-btn:hover {
        background: white;
        color: #00468B;
      }
      
      /* Calendar Styles */
      .calendar-container {
        display: none;
        font-family: 'Open Sans', sans-serif;
      }
      
      .calendar-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
      }
      
      .calendar-title {
        font-size: 24px;
        font-weight: 600;
        color: #00468B;
      }
      
      .calendar-nav {
        display: flex;
        gap: 10px;
      }
      
      .calendar-nav-btn {
        background: #232323;
        color: white;
        border: none;
        padding: 5px 10px;
        cursor: pointer;
        border-radius: 4px;
        font-family: 'Open Sans', sans-serif;
        border: 2px solid #232323;
        transition: 0.25s;
      }
      
      .calendar-nav-btn:hover {
        background: white;
        color: #232323;
      }
      
      .calendar-grid {
        display: grid;
        grid-template-columns: repeat(7, 1fr);
        gap: 5px;
      }
      
      .calendar-day-header {
        text-align: center;
        font-weight: 600;
        padding: 10px;
        background-color: #f5f5f5;
      }
      
      .calendar-day {
        min-height: 100px;
        border: 1px solid #eee;
        padding: 5px;
        position: relative;
      }
      
      .calendar-day.other-month {
        background-color: #f9f9f9;
        color: #aaa;
      }
      
      .calendar-day-number {
        font-weight: 600;
        margin-bottom: 5px;
      }
      
      .calendar-day.today {
        background-color: #f0f8ff;
        border: 1px solid #00468B;
      }
      
      .calendar-event {
        background-color: #00468B;
        color: white;
        padding: 2px 5px;
        margin-bottom: 3px;
        border-radius: 3px;
        font-size: 12px;
        cursor: pointer;
        overflow: hidden;
        white-space: normal;
        word-wrap: break-word;
        max-width: 100%;
        min-height: 20px;
        max-height: 40px;
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
      }
      
      .calendar-event.meetup {
        background-color: #4CAF50;
      }
      
      .calendar-event.conference {
        background-color: #00468B;
      }
      
      .calendar-event-tooltip {
        position: absolute;
        background-color: white;
        border: 1px solid #ddd;
        padding: 10px;
        border-radius: 4px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        z-index: 100;
        display: none;
        width: 200px;
      }
      
      .calendar-event:hover + .calendar-event-tooltip {
        display: block;
      }
    </style>
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-423060569"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-423060569');
    </script>
  </head>
  <body>
    <a href="index.html"><img src="https://raw.githubusercontent.com/pwicherski/testowanieoprogramowania.pl/main/quac-logo-05.png"></a>
    <h3 style="font-family: 'Open Sans', sans-serif; font-weight: 300;">Wydarzenia - Testowanie Oprogramowania</h3>
    
    <div class="container">
      <div class="tabs">
        <div class="tab active" id="tab-wszystkie">WSZYSTKIE</div>
        <div class="tab" id="tab-meetupy">MEETUPY</div>
        <div class="tab" id="tab-konferencje">KONFERENCJE</div>
        <div class="tab" id="tab-kalendarz">KALENDARZ</div>
        <button id="add-event-btn" class="add-event-btn"><i class="fas fa-plus"></i>ðŸ“†</button>
      </div>
      
      <div id="events-container">
        <!-- Events will be loaded here from JSON -->
      </div>
      
      <div id="calendar-container" class="calendar-container">
        <div class="calendar-header">
          <button id="prev-month" class="calendar-nav-btn"><i class="fas fa-chevron-left"></i></button>
          <div id="calendar-title" class="calendar-title">Maj 2025</div>
          <button id="next-month" class="calendar-nav-btn"><i class="fas fa-chevron-right"></i></button>
        </div>
        <div class="calendar-grid" id="calendar-grid">
          <!-- Calendar will be generated here -->
        </div>
      </div>
    </div>
    
    <script>
      // Function to convert English day names to Polish
      function getDayOfWeekInPolish(dayIndex) {
        const daysInPolish = [
          'niedziela', 'poniedziaÅ‚ek', 'wtorek', 'Å›roda', 
          'czwartek', 'piÄ…tek', 'sobota'
        ];
        return daysInPolish[dayIndex];
      }
      
      // Function to parse Polish date format (e.g., "12 maja 2023")
      function parseEventDate(dateStr) {
        // Handle empty date strings
        if (!dateStr || dateStr.trim() === '') {
          // Return a far future date for empty dates (will sort to the end)
          return new Date(9999, 11, 31);
        }
        
        // Map of Polish month names to their numeric values
        const monthsMap = {
          'stycznia': 0, 'lutego': 1, 'marca': 2, 'kwietnia': 3, 'maja': 4, 'czerwca': 5,
          'lipca': 6, 'sierpnia': 7, 'wrzeÅ›nia': 8, 'paÅºdziernika': 9, 'listopada': 10, 'grudnia': 11
        };
        
        try {
          // Split the date string into components
          const parts = dateStr.split(' ');
          
          // Check if we have all parts needed
          if (parts.length < 3) {
            return new Date(9999, 11, 31); // Invalid format, sort to end
          }
          
          // Handle date ranges (e.g., "12-13 maja 2023")
          let day = parts[0];
          if (day.includes('-')) {
            // For date ranges, use the first date
            day = day.split('-')[0];
          }
          
          const month = monthsMap[parts[1].toLowerCase()];
          const year = parseInt(parts[2]);
          
          // Check if all parts are valid
          if (isNaN(day) || month === undefined || isNaN(year)) {
            return new Date(9999, 11, 31); // Invalid data, sort to end
          }
          
          // Return a Date object
          return new Date(year, month, parseInt(day));
        } catch (error) {
          console.error('Error parsing date:', error);
          return new Date(9999, 11, 31); // Error case, sort to end
        }
      }
      
      // Function to format date with day of week
      function formatDateWithDayOfWeek(dateStr) {
        if (!dateStr || dateStr.trim() === '') {
          return '';
        }
        
        // Check if it's a date range (e.g., "05-07 listopada 2025")
        const parts = dateStr.split(' ');
        const dayPart = parts[0];
        
        if (dayPart.includes('-')) {
          // It's a date range, handle both dates
          const [startDay, endDay] = dayPart.split('-');
          const month = parts[1];
          const year = parts[2];
          
          // Create date objects for both start and end dates
          const startDateStr = `${startDay} ${month} ${year}`;
          const endDateStr = `${endDay} ${month} ${year}`;
          
          const startDate = parseEventDate(startDateStr);
          const endDate = parseEventDate(endDateStr);
          
          // Check if dates are valid
          if (startDate.getFullYear() === 9999 || endDate.getFullYear() === 9999) {
            return dateStr;
          }
          
          const startDayOfWeek = getDayOfWeekInPolish(startDate.getDay());
          const endDayOfWeek = getDayOfWeekInPolish(endDate.getDay());
          
          return `${dateStr} (${startDayOfWeek} - ${endDayOfWeek})`;
        } else {
          // It's a single date
          const date = parseEventDate(dateStr);
          
          // Check if date is valid (not the default far future date)
          if (date.getFullYear() === 9999) {
            return dateStr;
          }
          
          const dayOfWeek = getDayOfWeekInPolish(date.getDay());
          return `${dateStr} (${dayOfWeek})`;
      }
      }
      
      // Global variables for calendar view
      let currentDate = new Date();
      const monthsInPolish = [
        'StyczeÅ„', 'Luty', 'Marzec', 'KwiecieÅ„', 'Maj', 'Czerwiec',
        'Lipiec', 'SierpieÅ„', 'WrzesieÅ„', 'PaÅºdziernik', 'Listopad', 'GrudzieÅ„'
      ];
      
      document.addEventListener('DOMContentLoaded', function() {
        // Function to load and display events
        function loadAndDisplayEvents() {
          Promise.all([
            fetch('wydarzenia/konferencje.json').then(response => response.json()),
            fetch('wydarzenia/meetupy.json').then(response => response.json())
          ])
            .then(([konferencje, meetupy]) => {
              // Store data globally for reuse
              data = {
                konferencje: konferencje,
                meetupy: meetupy,
                wszystkie: [...konferencje, ...meetupy]
              };
              
              // Update tab counters immediately after loading data
              updateTabCounters();
              
              // Initially display all events
              displayEvents(data.wszystkie);
              
              // Initialize calendar with current month
              generateCalendar(currentDate);
            })
            .catch(error => {
              console.error('BÅ‚Ä…d podczas Å‚adowania danych:', error);
              document.getElementById('events-container').innerHTML = '<p>BÅ‚Ä…d podczas Å‚adowania wydarzeÅ„. SprÃ³buj ponownie pÃ³Åºniej.</p>';
            });
        }
        
        // Load events on page load
        loadAndDisplayEvents();
        
        // Tab switching functionality
        document.getElementById('tab-wszystkie').addEventListener('click', function() {
          setActiveTab('tab-wszystkie');
          showEventsView();
          displayEvents(data.wszystkie);
        });
        
        document.getElementById('tab-meetupy').addEventListener('click', function() {
          setActiveTab('tab-meetupy');
          showEventsView();
          displayEvents(data.meetupy);
        });
        
        document.getElementById('tab-konferencje').addEventListener('click', function() {
          setActiveTab('tab-konferencje');
          showEventsView();
          displayEvents(data.konferencje);
        });
        
        document.getElementById('tab-kalendarz').addEventListener('click', function() {
          setActiveTab('tab-kalendarz');
          showCalendarView();
          generateCalendar(currentDate);
        });
        
        // Add event listener for the 'Dodaj wydarzenie' button
        document.getElementById('add-event-btn').addEventListener('click', function() {
          window.open('https://github.com/pwicherski/testowanieoprogramowania.pl/tree/main/wydarzenia', '_blank');
        });
        
        // Calendar navigation buttons
        document.getElementById('prev-month').addEventListener('click', function() {
          currentDate.setMonth(currentDate.getMonth() - 1);
          generateCalendar(currentDate);
        });
        
        document.getElementById('next-month').addEventListener('click', function() {
          currentDate.setMonth(currentDate.getMonth() + 1);
          generateCalendar(currentDate);
        });
        
        // Helper function to set active tab
        function setActiveTab(activeTabId) {
          document.getElementById('tab-wszystkie').classList.remove('active');
          document.getElementById('tab-meetupy').classList.remove('active');
          document.getElementById('tab-konferencje').classList.remove('active');
          document.getElementById('tab-kalendarz').classList.remove('active');
          document.getElementById(activeTabId).classList.add('active');
        }
        
        // Helper function to show events view and hide calendar view
        function showEventsView() {
          document.getElementById('events-container').style.display = 'block';
          document.getElementById('calendar-container').style.display = 'none';
        }
        
        // Helper function to show calendar view and hide events view
        function showCalendarView() {
          document.getElementById('events-container').style.display = 'none';
          document.getElementById('calendar-container').style.display = 'block';
        }
      });
      
      let data = [];
      
      // Function to filter future events
      function filterFutureEvents(events) {
        const today = new Date();
        // Reset time to start of day for fair comparison
        today.setHours(0, 0, 0, 0);
        
        return events.filter(event => {
          const eventDate = parseEventDate(event.data);
          return eventDate >= today && eventDate.getFullYear() !== 9999;
        });
      }
      
      // Function to update tab counters
      function updateTabCounters() {
        const futureWszystkie = filterFutureEvents(data.wszystkie);
        const futureMeetupy = filterFutureEvents(data.meetupy);
        const futureKonferencje = filterFutureEvents(data.konferencje);
        
        document.getElementById('tab-wszystkie').textContent = `WSZYSTKIE [${futureWszystkie.length}]`;
        document.getElementById('tab-meetupy').textContent = `MEETUPY [${futureMeetupy.length}]`;
        document.getElementById('tab-konferencje').textContent = `KONFERENCJE [${futureKonferencje.length}]`;
      }
      
      // Function to generate calendar
      function generateCalendar(date) {
        const year = date.getFullYear();
        const month = date.getMonth();
        
        // Update calendar title
        document.getElementById('calendar-title').textContent = `${monthsInPolish[month]} ${year}`;
        
        // Get the first day of the month
        const firstDay = new Date(year, month, 1);
        // Get the last day of the month
        const lastDay = new Date(year, month + 1, 0);
        
        // Get the day of the week for the first day (0 = Sunday, 1 = Monday, etc.)
        let firstDayOfWeek = firstDay.getDay();
        // Adjust for Monday as first day of week (0 = Monday, 6 = Sunday)
        firstDayOfWeek = firstDayOfWeek === 0 ? 6 : firstDayOfWeek - 1;
        
        // Get the number of days in the month
        const daysInMonth = lastDay.getDate();
        
        // Get the grid container
        const calendarGrid = document.getElementById('calendar-grid');
        calendarGrid.innerHTML = '';
        
        // Add day headers (Monday to Sunday)
        const daysOfWeek = ['Pon', 'Wt', 'Åšr', 'Czw', 'Pt', 'Sob', 'Nie'];
        daysOfWeek.forEach(day => {
          const dayHeader = document.createElement('div');
          dayHeader.className = 'calendar-day-header';
          dayHeader.textContent = day;
          calendarGrid.appendChild(dayHeader);
        });
        
        // Add days from previous month
        const prevMonth = new Date(year, month, 0);
        const daysInPrevMonth = prevMonth.getDate();
        for (let i = 0; i < firstDayOfWeek; i++) {
          const dayElement = document.createElement('div');
          dayElement.className = 'calendar-day other-month';
          dayElement.innerHTML = `<div class="calendar-day-number">${daysInPrevMonth - firstDayOfWeek + i + 1}</div>`;
          calendarGrid.appendChild(dayElement);
        }
        
        // Add days of current month
        const today = new Date();
        for (let i = 1; i <= daysInMonth; i++) {
          const dayElement = document.createElement('div');
          dayElement.className = 'calendar-day';
          
          // Check if this day is today
          if (year === today.getFullYear() && month === today.getMonth() && i === today.getDate()) {
            dayElement.classList.add('today');
          }
          
          dayElement.innerHTML = `<div class="calendar-day-number">${i}</div>`;
          
          // Add events for this day
          const currentDate = new Date(year, month, i);
          addEventsToDay(dayElement, currentDate);
          
          calendarGrid.appendChild(dayElement);
        }
        
        // Add days from next month to fill the grid
        const totalCells = 42; // 6 rows of 7 days
        const remainingCells = totalCells - (firstDayOfWeek + daysInMonth);
        for (let i = 1; i <= remainingCells; i++) {
          const dayElement = document.createElement('div');
          dayElement.className = 'calendar-day other-month';
          dayElement.innerHTML = `<div class="calendar-day-number">${i}</div>`;
          calendarGrid.appendChild(dayElement);
        }
      }
      
      // Function to add events to a day in the calendar
      function addEventsToDay(dayElement, date) {
        // Format date to match event date format (e.g., "15 maja 2025")
        const day = date.getDate();
        const monthIndex = date.getMonth();
        const year = date.getFullYear();
        
        // Map of month indices to Polish month names in genitive case
        const monthsGenitive = [
          'stycznia', 'lutego', 'marca', 'kwietnia', 'maja', 'czerwca',
          'lipca', 'sierpnia', 'wrzeÅ›nia', 'paÅºdziernika', 'listopada', 'grudnia'
        ];
        
        // Events for this day
        const eventsForDay = data.wszystkie.filter(event => {
          // Handle empty dates
          if (!event.data || event.data.trim() === '') {
            return false;
          }
          
          // Check if it's a date range (e.g., "05-07 listopada 2025")
          const parts = event.data.split(' ');
          const dayPart = parts[0];
          const monthName = parts[1];
          const eventYear = parseInt(parts[2]);
          
          if (dayPart.includes('-')) {
            // It's a date range
            const [startDay, endDay] = dayPart.split('-').map(d => parseInt(d));
            const eventMonthIndex = monthsGenitive.indexOf(monthName.toLowerCase());
            
            // Check if the current date falls within the range
            if (year === eventYear && monthIndex === eventMonthIndex) {
              return day >= startDay && day <= endDay;
            }
            return false;
          } else {
            // It's a single date
            const eventDay = parseInt(dayPart);
            const eventMonthIndex = monthsGenitive.indexOf(monthName.toLowerCase());
            
            return day === eventDay && monthIndex === eventMonthIndex && year === eventYear;
          }
        });
        
        // Add events to the day element
        eventsForDay.forEach(event => {
          const eventElement = document.createElement('div');
          eventElement.className = `calendar-event ${event.kategoria.toLowerCase() === 'meetup' ? 'meetup' : 'conference'}`;
          
          // Format event name to wrap after 24 characters at whitespace
          const eventName = event.nazwa;
          eventElement.textContent = eventName;
          
          // Create tooltip with event details
          const tooltipElement = document.createElement('div');
          tooltipElement.className = 'calendar-event-tooltip';
          tooltipElement.innerHTML = `
            <strong>${event.nazwa}</strong><br>
            <i class="fas fa-calendar-alt"></i> ${event.data}<br>
            <i class="fas fa-map-marker-alt"></i> ${event.miejsce}<br>
            <i class="fas fa-tag"></i> ${event.kategoria}
          `;
          
          // Add click event to open the event link
          eventElement.addEventListener('click', function() {
            window.open(event.link, '_blank');
          });
          
          dayElement.appendChild(eventElement);
          dayElement.appendChild(tooltipElement);
        });
      }
      
      function displayEvents(events) {
        const container = document.getElementById('events-container');
        container.innerHTML = '';
        
        // Filter to only show current and future events
        const futureEvents = filterFutureEvents(events);
        
        // Sort events by date from closest to furthest
        futureEvents.sort((a, b) => {
          // Parse the date strings to Date objects for comparison
          const dateA = parseEventDate(a.data);
          const dateB = parseEventDate(b.data);
          return dateA - dateB;
        });
        
        // Update tab counters after sorting
        updateTabCounters();
        
        // Filter out events with no name
        futureEvents.filter(event => event.nazwa && event.nazwa.trim() !== '').forEach(event => {
          const eventElement = document.createElement('div');
          eventElement.className = 'event';
          
          // Twitter handles removed as requested
          
          let statusHtml = '';
          if (event.status && event.status !== 'Rejestracja otwarta') {
            statusHtml = `<div class="event-status"><i class="fas fa-ticket-alt"></i> ${event.status}</div>`;
          }
          
          // Format category
          const categoryText = event.kategoria === 'Meetup' ? 'Meetup' : 'Konferencja';
          
          eventElement.innerHTML = `
            <h3 style="font-size: 28px;"><a href="${event.link}" target="_blank">${event.nazwa}</a></h3>
            <div class="event-info">
              <i class="fas fa-calendar-alt"></i> ${formatDateWithDayOfWeek(event.data)}
            </div>
            <div class="event-info">
              <i class="fas fa-map-marker-alt"></i> ${event.miejsce}
            </div>
            <div class="event-info">
              <i class="fas fa-tag"></i> ${categoryText}
            </div>
            <div class="event-info">
              <i class="fas fa-link fa-sm"></i> <a href="${event.link}" target="_blank" style="font-size: 16px; text-decoration: none; color: inherit; background: transparent; padding: 0; width: auto; border: none; display: inline; transition: none;">Link do wydarzenia</a>
            </div>
            ${statusHtml}
          `;
          
          // Remove the clickable behavior from the entire div since we now have a dedicated link
          container.appendChild(eventElement);
        });
      }
    </script>
    
    <footer class="footer">
      <a href="polityka-prywatnosci.html">Polityka PrywatnoÅ›ci</a>
    </footer>
  </body>
</html>